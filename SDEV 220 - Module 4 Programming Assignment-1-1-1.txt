#zoo.py
def hours():
    print("Open 9-5 daily")


#11.1
import zoo

zoo.hours()


#11.2
import zoo as menagerie

menagerie.hours()

#16.3
import csv

books = [
    ["title","author","year"],
    ["The Weirdstone of Brisingamen","Alan Garner",1960],
    ["Perdido Street Station","China Mi√©ville",2000],
    ["Thud!","Terry Pratchett",2005],
    ["The Spellman Files","Lisa Lutz",2007],
    ["Small Gods","Terry Pratchett",1992],
    ]

with open("books2", "wt") as fout:
    cvsout = csv.writer(fout)
    cvsout.writerows(books)

#16.4
import sqlite3

conn = sqlite3.connect('books.db')
curs = conn.cursor()
curs.execute('''CREATE TABLE books
    (title VARCHAR(50) PRIMARY KEY,
     author VARCHAR(50),
     year INT)''')

#16.5
conn = sqlite3.connect('books.db')
curs = conn.cursor()
ins = 'INSERT INTO books (title, author, year) VALUES (?, ?, ?)'

with open("books2", "rt") as fin:
    cin = csv.DictReader(fin)
    books = [row for row in cin]

for book in books:
    title = book["title"]
    author = book["author"]
    year = book["year"]
    curs.execute(ins, (title, author, year))

#16.6
curs.execute('SELECT title FROM books ORDER BY title')
rows = curs.fetchall()

for row in rows:
    print(row[0])

#16.7
curs.execute('SELECT * FROM books ORDER BY year')
rows = curs.fetchall()

for row in rows:
    print(row[0], row[1], row[3])

#16.8
from sqlalchemy import create_engine
from sqlalchemy import engine
import sqlalchemy as sa

with engine.connect() as conn:
    conn = sa.create_engine('sqlite:///books.db')
    result = conn.execute(books.select())
    rows = result.fetchall()
    for row in rows:
        print(row)
